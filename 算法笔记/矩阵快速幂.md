## 矩阵快速幂


```cpp
struct Matrix {
    vector<vector<int64_t> > mat;
    int n, m;

    Matrix(int n_, int m_) : n(n_), m(m_) {
        mat.resize(n, vector<int64_t>(m, 0));
    }

    // 矩阵乘法
    Matrix operator*(const Matrix &B) const {
        Matrix result(n, B.m);
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < B.m; ++j) {
                for (int k = 0; k < m; ++k) {
                    result.mat[i][j] += mat[i][k] * B.mat[k][j];    // % mod
                }
            }
        }
        return result;
    }

    // 只对方阵有效
    Matrix operator^(int64_t power) const {
        Matrix result(n, m);
        for (int i = 0; i < n; ++i) {
            result.mat[i][i] = 1;
        }
        Matrix base = *this;

        while (power) {
            if (power & 1) {
                result = result * base;
            }
            base = base * base;
            power >>= 1;
        }
        return result;
    }
};
```