$$C^{m}_n = \frac{n!}{(n-m)!m!}$$


```c++
using ll = long long;

// 快速幂计算 a^b % p
ll ksm_mod(ll a, ll b, ll p) {
    ll res = 1;
    while (b > 0) {
        if (b & 1) res = res * a % p;
        a = a * a % p;
        b >>= 1;
    }
    return res;
}

// 计算逆元 a^(p-2) % p，基于费马小定理
ll inv(ll a, ll p) {
    return ksm_mod(a, p - 2, p);
}

// 计算阶乘 n! % p
ll factorial_mod(ll n, ll p) {
    ll res = 1;
    for (ll i = 2; i <= n; ++i) {
        res = res * i % p;
    }
    return res;
}

// 计算 C(n, m) % p，适用于 n < p
ll C(ll n, ll m, ll p) {
    if (m > n) return 0;  // 如果 m > n，组合数为 0
    ll numerator = factorial_mod(n, p); // 分子
    ll denominator = factorial_mod(m, p) * factorial_mod(n - m, p) % p; // 分母
    return numerator * inv(denominator, p) % p;
}

// 使用 Lucas 定理计算 C(n, m) mod p
ll lucas(ll n, ll m, ll p) {
    if (m == 0) return 1;  // m 为 0 时组合数为 1
    if (n < p && m < p) return C(n, m, p);
    return lucas(n / p, m / p, p) * C(n % p, m % p, p) % p;
}
```