### 前言

智能指针（smart pointer）是一种用来防止内存泄漏的编程技术，它利用对象管理资源的方式（又名RAII——Resource Acquisition Is Initialization），即利用对象析构函数在生命周期结束时自行调用的特性，让编译器自行释放动态开辟的空间。

### 1 内存泄漏

#### 1.1 内存泄漏的定义

内存泄漏通常发生在使用了new或malloc等函数动态分配内存后，忘记了对应的delete或free调用，或者是因为逻辑错误导致这些调用未能执行。这种情况下，程序占用的内存会逐渐增加，最终可能导致系统资源耗尽，程序崩溃或运行缓慢。

#### 1.2 内存泄漏的常见原因

1. **忘记释放内存**：程序员在堆上动态分配内存后，忘记或未能正确地释放它。
1. **异常处理不当**：当程序发生异常时，执行流程可能会发生改变，导致某些正常流程中的内存释放操作无法执行

3. **拷贝构造函数和赋值运算符未正确处理动态内存**：当类对象包含动态分配的内存时，拷贝构造函数和赋值运算符需要特别处理，以确保在对象复制或赋值时不会导致内存泄漏。
4. **容器使用不当**：C++标准库提供了许多容器类（如std::vector、std::string等），它们内部自动管理内存。然而，如果在使用这些容器时不当（如将一个容器作为另一个容器的元素，并在某个时刻改变了容器的容量），也可能导致内存泄漏。

5. **循环引用**：两个或多个对象相互引用，形成一个循环，导致内存无法被释放。（往下会介绍此种泄露的原因和解决办法）

#### 1.3 内存泄漏的危害

内存泄漏会导致程序占用的内存逐渐增加，最终可能导致系统资源耗尽，程序崩溃或运行缓慢。此外，内存泄漏还可能引发其他严重问题，如内存碎片、系统不稳定等。
智能指针的出现就是解决这种危害的一种方法。